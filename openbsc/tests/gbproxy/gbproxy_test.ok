===== GbProxy test START
Test shift functions
=== test_gbproxy ===
--- Initialise SGSN ---

MESSAGE to SGSN at 0x05060708:32000, msg length 12
02 00 81 01 01 82 01 01 04 82 01 00 

PROCESSING RESET_ACK from 0x05060708:32000
03 01 82 01 01 04 82 01 00 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0a 

result (RESET_ACK) = 1

PROCESSING ALIVE_ACK from 0x05060708:32000
0b 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
06 

result (ALIVE_ACK) = 1

PROCESSING UNBLOCK_ACK from 0x05060708:32000
07 

==> got signal NS_UNBLOCK, NS-VC 0x0101/5.6.7.8:32000

result (UNBLOCK_ACK) = 0

PROCESSING ALIVE from 0x05060708:32000
0a 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0b 

result (ALIVE) = 1

Current NS-VCIs:
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

--- Initialise BSS 1 ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x1001(4097), NSEI 0x1000(4096)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 10 01 04 82 10 00 

==> got signal NS_RESET, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 10 01 04 82 10 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

Current NS-VCIs:
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

--- Initialise BSS 2 ---

Setup NS-VC: remote 0x01020304:2222, NSVCI 0x2001(8193), NSEI 0x2000(8192)

PROCESSING RESET from 0x01020304:2222
02 00 81 01 01 82 20 01 04 82 20 00 

==> got signal NS_RESET, NS-VC 0x2001/1.2.3.4:2222

MESSAGE to BSS at 0x01020304:2222, msg length 9
03 01 82 20 01 04 82 20 00 

MESSAGE to BSS at 0x01020304:2222, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:2222
0a 

MESSAGE to BSS at 0x01020304:2222, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:2222
06 

==> got signal NS_UNBLOCK, NS-VC 0x2001/1.2.3.4:2222

MESSAGE to BSS at 0x01020304:2222, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:2222
0b 

result (ALIVE_ACK) = 0

Setup BSSGP: remote 0x01020304:2222, BVCI 0x2002(8194)

PROCESSING BVC_RESET from 0x01020304:2222
00 00 00 00 22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:2222
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 20 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 20 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:2222, msg length 9
00 00 00 00 23 04 82 20 02 

result (BVC_RESET_ACK) = 9

--- Move BSS 1 to new port ---

Setup NS-VC: remote 0x01020304:3333, NSVCI 0x1001(4097), NSEI 0x1000(4096)

PROCESSING RESET from 0x01020304:3333
02 00 81 01 01 82 10 01 04 82 10 00 

==> got signal NS_RESET, NS-VC 0x1001/1.2.3.4:3333

MESSAGE to BSS at 0x01020304:3333, msg length 9
03 01 82 10 01 04 82 10 00 

MESSAGE to BSS at 0x01020304:3333, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:3333
0a 

MESSAGE to BSS at 0x01020304:3333, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:3333
06 

==> got signal NS_UNBLOCK, NS-VC 0x1001/1.2.3.4:3333

MESSAGE to BSS at 0x01020304:3333, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:3333
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:2222
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:3333
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
--- Move BSS 2 to former BSS 1 port ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x2001(8193), NSEI 0x2000(8192)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 20 01 04 82 20 00 

==> got signal NS_RESET, NS-VC 0x2001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 20 01 04 82 20 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x2001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:1111
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:3333
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
--- Move BSS 1 to current BSS 2 port ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x2001(8193), NSEI 0x2000(8192)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 20 01 04 82 20 00 

==> got signal NS_RESET, NS-VC 0x2001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 20 01 04 82 20 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x2001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:1111
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:3333
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
--- Move BSS 2 to new port ---

Setup NS-VC: remote 0x01020304:4444, NSVCI 0x2001(8193), NSEI 0x2000(8192)

PROCESSING RESET from 0x01020304:4444
02 00 81 01 01 82 20 01 04 82 20 00 

==> got signal NS_RESET, NS-VC 0x2001/1.2.3.4:4444

MESSAGE to BSS at 0x01020304:4444, msg length 9
03 01 82 20 01 04 82 20 00 

MESSAGE to BSS at 0x01020304:4444, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:4444
0a 

MESSAGE to BSS at 0x01020304:4444, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:4444
06 

==> got signal NS_UNBLOCK, NS-VC 0x2001/1.2.3.4:4444

MESSAGE to BSS at 0x01020304:4444, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:4444
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:4444
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:3333
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
--- Move BSS 2 to former BSS 1 port ---

Setup NS-VC: remote 0x01020304:3333, NSVCI 0x2001(8193), NSEI 0x2000(8192)

PROCESSING RESET from 0x01020304:3333
02 00 81 01 01 82 20 01 04 82 20 00 

==> got signal NS_REPLACED: 0x2001/1.2.3.4:4444 -> 0x1001/1.2.3.4:3333

==> got signal NS_RESET, NS-VC 0x2001/1.2.3.4:3333

MESSAGE to BSS at 0x01020304:3333, msg length 9
03 01 82 20 01 04 82 20 00 

MESSAGE to BSS at 0x01020304:3333, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:3333
0a 

MESSAGE to BSS at 0x01020304:3333, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:3333
06 

==> got signal NS_UNBLOCK, NS-VC 0x2001/1.2.3.4:3333

MESSAGE to BSS at 0x01020304:3333, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:3333
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:3333
         NS-VC replaced other count: 1
    VCI 0x1001, NSEI 0x1000, peer 0x00000000:0
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
--- Move BSS 1 to original BSS 1 port ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x1001(4097), NSEI 0x1000(4096)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 10 01 04 82 10 00 

==> got signal NS_RESET, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 10 01 04 82 10 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:3333
         NS-VC replaced other count: 1
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
--- Reset BSS 1 with a new BVCI ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1012(4114)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 12 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 12 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 12 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:3333
         NS-VC replaced other count: 1
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 4096, BVCI 4114, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 12 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 12 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 12 

result (BVC_RESET_ACK) = 9

--- Reset BSS 1 with the old BVCI ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:3333
         NS-VC replaced other count: 1
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 4096, BVCI 4114, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

--- Reset BSS 1 with the old BVCI again ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:3333
         NS-VC replaced other count: 1
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 4096, BVCI 4114, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

--- Send message from BSS 1 to SGSN, BVCI 0x1012 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 10 12 

CALLBACK, event 0, msg length 0, bvci 0x1012
00 00 10 12 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1012, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 10 12 

result (UNITDATA) = 4

--- Send message from SGSN to BSS 1, BVCI 0x1012 ---

PROCESSING UNITDATA from 0x05060708:32000
00 00 10 12 

CALLBACK, event 0, msg length 0, bvci 0x1012
00 00 10 12 

NS UNITDATA MESSAGE to BSS, BVCI 0x1012, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 10 12 

result (UNITDATA) = 4

--- Send message from BSS 1 to SGSN, BVCI 0x1002 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 10 12 

CALLBACK, event 0, msg length 0, bvci 0x1012
00 00 10 12 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1012, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 10 12 

result (UNITDATA) = 4

--- Send message from SGSN to BSS 1, BVCI 0x1002 ---

PROCESSING UNITDATA from 0x05060708:32000
00 00 10 12 

CALLBACK, event 0, msg length 0, bvci 0x1012
00 00 10 12 

NS UNITDATA MESSAGE to BSS, BVCI 0x1012, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 10 12 

result (UNITDATA) = 4

--- Send message from BSS 2 to SGSN, BVCI 0x2002 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 20 02 

CALLBACK, event 0, msg length 0, bvci 0x2002
00 00 20 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x2002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 20 02 

result (UNITDATA) = 4

--- Send message from SGSN to BSS 2, BVCI 0x2002 ---

PROCESSING UNITDATA from 0x05060708:32000
00 00 20 02 

CALLBACK, event 0, msg length 0, bvci 0x2002
00 00 20 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x2002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:3333, msg length 4
00 00 20 02 

result (UNITDATA) = 4

--- Reset BSS 1 with the old BVCI on BSS2's link ---

Setup BSSGP: remote 0x01020304:3333, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:3333
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:3333
         NS-VC replaced other count: 1
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 4096, BVCI 4114, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
Gbproxy global:
PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:3333, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

--- Send message from BSS 1 to SGSN, BVCI 0x1002 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 10 12 

CALLBACK, event 0, msg length 0, bvci 0x1012
00 00 10 12 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1012, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 10 12 

result (UNITDATA) = 4

--- Send message from SGSN to BSS 1, BVCI 0x1002 ---

PROCESSING UNITDATA from 0x05060708:32000
00 00 10 12 

CALLBACK, event 0, msg length 0, bvci 0x1012
00 00 10 12 

NS UNITDATA MESSAGE to BSS, BVCI 0x1012, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 10 12 

result (UNITDATA) = 4

--- Send message from SGSN to BSS 1, BVCI 0x10ff (invalid) ---

PROCESSING UNITDATA from 0x05060708:32000
00 00 10 ff 

CALLBACK, event 0, msg length 0, bvci 0x10ff
00 00 10 ff 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 10 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 14
00 00 00 00 41 07 81 05 04 82 10 ff 15 80 

result (UNITDATA) = 14

Gbproxy global:
    Invalid BVC Identifier          : 1
=== test_gbproxy_ident_changes ===
--- Initialise SGSN ---

MESSAGE to SGSN at 0x05060708:32000, msg length 12
02 00 81 01 01 82 01 01 04 82 01 00 

PROCESSING RESET_ACK from 0x05060708:32000
03 01 82 01 01 04 82 01 00 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0a 

result (RESET_ACK) = 1

PROCESSING ALIVE_ACK from 0x05060708:32000
0b 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
06 

result (ALIVE_ACK) = 1

PROCESSING UNBLOCK_ACK from 0x05060708:32000
07 

==> got signal NS_UNBLOCK, NS-VC 0x0101/5.6.7.8:32000

result (UNBLOCK_ACK) = 0

PROCESSING ALIVE from 0x05060708:32000
0a 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0b 

result (ALIVE) = 1

Current NS-VCIs:
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

--- Initialise BSS 1 ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x1001(4097), NSEI 0x1000(4096)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 10 01 04 82 10 00 

==> got signal NS_RESET, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 10 01 04 82 10 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

--- Setup BVCI 1 ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
--- Setup BVCI 2 ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x2002(8194)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 20 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 20 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 20 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 20 02 

result (BVC_RESET_ACK) = 9

Peers:
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
--- Send message from BSS 1 to SGSN and back, BVCI 1 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 10 02 

CALLBACK, event 0, msg length 0, bvci 0x1002
00 00 10 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 10 02 

result (UNITDATA) = 4

PROCESSING UNITDATA from 0x05060708:32000
00 00 10 02 

CALLBACK, event 0, msg length 0, bvci 0x1002
00 00 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 10 02 

result (UNITDATA) = 4

--- Send message from BSS 1 to SGSN and back, BVCI 2 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 20 02 

CALLBACK, event 0, msg length 0, bvci 0x2002
00 00 20 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x2002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 20 02 

result (UNITDATA) = 4

PROCESSING UNITDATA from 0x05060708:32000
00 00 20 02 

CALLBACK, event 0, msg length 0, bvci 0x2002
00 00 20 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x2002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 20 02 

result (UNITDATA) = 4

--- Change NSEI ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x1001(4097), NSEI 0x2000(8192)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 10 01 04 82 20 00 

==> got signal NS_RESET, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 10 01 04 82 20 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x1001, NSEI 0x2000, peer 0x01020304:1111
         NS-VC changed NSEI count  : 1
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

--- Setup BVCI 1 ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

Peers:
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
--- Setup BVCI 3 ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x3002(12290)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 30 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 30 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 30 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 30 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 30 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 30 02 

result (BVC_RESET_ACK) = 9

Peers:
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
--- Send message from BSS 1 to SGSN and back, BVCI 1 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 10 02 

CALLBACK, event 0, msg length 0, bvci 0x1002
00 00 10 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 10 02 

result (UNITDATA) = 4

PROCESSING UNITDATA from 0x05060708:32000
00 00 10 02 

CALLBACK, event 0, msg length 0, bvci 0x1002
00 00 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 10 02 

result (UNITDATA) = 4

--- Send message from BSS 1 to SGSN and back, BVCI 2  (should fail) ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 20 02 

CALLBACK, event 0, msg length 0, bvci 0x2002
00 00 20 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x2002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 20 02 

result (UNITDATA) = 4

Peers:
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
PROCESSING UNITDATA from 0x05060708:32000
00 00 20 02 

CALLBACK, event 0, msg length 0, bvci 0x2002
00 00 20 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x2002, msg length 0 (gprs_ns_sendmsg)
result (UNITDATA) = -22

Peers:
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    NS Transmission error           : 1
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
--- Send message from BSS 1 to SGSN and back, BVCI 3 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 30 02 

CALLBACK, event 0, msg length 0, bvci 0x3002
00 00 30 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x3002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 30 02 

result (UNITDATA) = 4

PROCESSING UNITDATA from 0x05060708:32000
00 00 30 02 

CALLBACK, event 0, msg length 0, bvci 0x3002
00 00 30 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x3002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 30 02 

result (UNITDATA) = 4

--- Change NSVCI ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x2001(8193), NSEI 0x2000(8192)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 20 01 04 82 20 00 

==> got signal NS_REPLACED: 0x2001/0.0.0.0:0 -> 0x1001/1.2.3.4:1111

==> got signal NS_RESET, NS-VC 0x2001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 20 01 04 82 20 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x2001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Current NS-VCIs:
    VCI 0x2001, NSEI 0x2000, peer 0x01020304:1111
         NS-VC replaced other count: 1
    VCI 0x1001, NSEI 0x2000, peer 0x00000000:0
         NS-VC changed NSEI count  : 1
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

--- Setup BVCI 1 ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

Peers:
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    NS Transmission error           : 1
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
--- Setup BVCI 4 ---

Setup BSSGP: remote 0x01020304:1111, BVCI 0x4002(16386)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 40 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 40 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 40 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

result (BVC_RESET) = 22

PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 40 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 40 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 40 02 

result (BVC_RESET_ACK) = 9

Peers:
  NSEI 8192, BVCI 16386, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    NS Transmission error           : 1
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
--- Send message from BSS 1 to SGSN and back, BVCI 1 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 10 02 

CALLBACK, event 0, msg length 0, bvci 0x1002
00 00 10 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 10 02 

result (UNITDATA) = 4

PROCESSING UNITDATA from 0x05060708:32000
00 00 10 02 

CALLBACK, event 0, msg length 0, bvci 0x1002
00 00 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 10 02 

result (UNITDATA) = 4

--- Send message from BSS 1 to SGSN and back, BVCI 2  (should fail) ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 20 02 

CALLBACK, event 0, msg length 0, bvci 0x2002
00 00 20 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x2002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 20 02 

result (UNITDATA) = 4

Peers:
  NSEI 8192, BVCI 16386, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 2
    NS Transmission error           : 1
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
PROCESSING UNITDATA from 0x05060708:32000
00 00 20 02 

CALLBACK, event 0, msg length 0, bvci 0x2002
00 00 20 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x2002, msg length 0 (gprs_ns_sendmsg)
result (UNITDATA) = -22

Peers:
  NSEI 8192, BVCI 16386, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 2
    NS Transmission error           : 2
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
--- Send message from BSS 1 to SGSN and back, BVCI 3 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 30 02 

CALLBACK, event 0, msg length 0, bvci 0x3002
00 00 30 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x3002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 30 02 

result (UNITDATA) = 4

PROCESSING UNITDATA from 0x05060708:32000
00 00 30 02 

CALLBACK, event 0, msg length 0, bvci 0x3002
00 00 30 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x3002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 30 02 

result (UNITDATA) = 4

--- Send message from BSS 1 to SGSN and back, BVCI 4 ---

PROCESSING UNITDATA from 0x01020304:1111
00 00 40 02 

CALLBACK, event 0, msg length 0, bvci 0x4002
00 00 40 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x4002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 4
00 00 40 02 

result (UNITDATA) = 4

PROCESSING UNITDATA from 0x05060708:32000
00 00 40 02 

CALLBACK, event 0, msg length 0, bvci 0x4002
00 00 40 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x4002, msg length 0 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 4
00 00 40 02 

result (UNITDATA) = 4

Gbproxy global:
Peers:
  NSEI 8192, BVCI 16386, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 8192, BVCI 12290, not blocked, RAI 112-332-16464-96
    TLLI-Cache: 0
  NSEI 4096, BVCI 8194, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 2
    NS Transmission error           : 2
    TLLI-Cache: 0
  NSEI 8192, BVCI 4098, not blocked, RAI 112-332-16464-96
    NSEI mismatch                   : 1
    TLLI-Cache: 0
=== Test IMSI/TMSI matching ===

=== test_gbproxy_ra_patching ===
--- Initialise SGSN ---

MESSAGE to SGSN at 0x05060708:32000, msg length 12
02 00 81 01 01 82 01 01 04 82 01 00 

PROCESSING RESET_ACK from 0x05060708:32000
03 01 82 01 01 04 82 01 00 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0a 

result (RESET_ACK) = 1

PROCESSING ALIVE_ACK from 0x05060708:32000
0b 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
06 

result (ALIVE_ACK) = 1

PROCESSING UNBLOCK_ACK from 0x05060708:32000
07 

==> got signal NS_UNBLOCK, NS-VC 0x0101/5.6.7.8:32000

result (UNBLOCK_ACK) = 0

PROCESSING ALIVE from 0x05060708:32000
0a 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0b 

result (ALIVE) = 1

Current NS-VCIs:
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

--- Initialise BSS 1 ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x1001(4097), NSEI 0x1000(4096)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 10 01 04 82 10 00 

==> got signal NS_RESET, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 10 01 04 82 10 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 21 63 54 40 50 60 10 00 

result (BVC_RESET) = 22

Current NS-VCIs:
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 1
    TLLI-Cache: 0
PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

PROCESSING BVC_SUSPEND from 0x01020304:1111
00 00 00 00 0b 1f 84 cc d1 75 8b 1b 86 11 22 33 40 50 60 

CALLBACK, event 0, msg length 15, bvci 0x0000
00 00 00 00 0b 1f 84 cc d1 75 8b 1b 86 11 22 33 40 50 60 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 15 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 19
00 00 00 00 0b 1f 84 cc d1 75 8b 1b 86 21 63 54 40 50 60 

result (BVC_SUSPEND) = 19

PROCESSING BVC_SUSPEND_ACK from 0x05060708:32000
00 00 00 00 0c 1f 84 cc d1 75 8b 1b 86 21 63 54 40 50 60 1d 81 01 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 0c 1f 84 cc d1 75 8b 1b 86 21 63 54 40 50 60 1d 81 01 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 22
00 00 00 00 0c 1f 84 cc d1 75 8b 1b 86 11 22 33 40 50 60 1d 81 01 

result (BVC_SUSPEND_ACK) = 22

Gbproxy global:
Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 2
    RAID patched              (SGSN): 1
    TLLI-Cache: 0
--- Send message from BSS 1 to SGSN, BVCI 0x1002 ---

PROCESSING ATTACH REQUEST from 0x01020304:1111
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 11 22 33 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 16 6d 01 

CALLBACK, event 0, msg length 75, bvci 0x1002
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 11 22 33 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 16 6d 01 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 75 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 79
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 21 63 54 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 8e cd 32 

result (ATTACH REQUEST) = 79

PROCESSING IDENT REQUEST from 0x05060708:32000
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

CALLBACK, event 0, msg length 23, bvci 0x1002
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 23 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 27
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

result (IDENT REQUEST) = 27

PROCESSING IDENT RESPONSE from 0x01020304:1111
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 11 01 c0 0d 08 16 08 11 12 13 14 15 16 17 18 b7 1b 9a 

CALLBACK, event 0, msg length 40, bvci 0x1002
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 11 01 c0 0d 08 16 08 11 12 13 14 15 16 17 18 b7 1b 9a 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 40 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 44
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 11 01 c0 0d 08 16 08 11 12 13 14 15 16 17 18 b7 1b 9a 

result (IDENT RESPONSE) = 44

PROCESSING ATTACH ACCEPT from 0x05060708:32000
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 21 63 54 40 50 60 19 cd d7 08 17 16 18 05 f4 ef e2 b7 00 53 62 f1 

CALLBACK, event 0, msg length 88, bvci 0x1002
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 21 63 54 40 50 60 19 cd d7 08 17 16 18 05 f4 ef e2 b7 00 53 62 f1 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 88 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 92
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 11 22 33 40 50 60 19 cd d7 08 17 16 18 05 f4 ef e2 b7 00 be 38 c0 

result (ATTACH ACCEPT) = 92

PROCESSING ATTACH COMPLETE from 0x01020304:1111
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 08 01 c0 11 08 03 ea 67 11 

CALLBACK, event 0, msg length 31, bvci 0x1002
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 08 01 c0 11 08 03 ea 67 11 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 31 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 35
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 08 01 c0 11 08 03 ea 67 11 

result (ATTACH COMPLETE) = 35

PROCESSING ACT PDP CTX REQ (REPLACE APN) from 0x01020304:1111
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

CALLBACK, event 0, msg length 76, bvci 0x1002
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 81 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 85
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 3a 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 08 03 66 6f 6f 03 62 61 72 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 24 9d 75 

result (ACT PDP CTX REQ (REPLACE APN)) = 85

PROCESSING GMM INFO from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

CALLBACK, event 0, msg length 66, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 66 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 70
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

result (GMM INFO) = 70

PROCESSING ACT PDP CTX REQ (REPLACE APN) from 0x01020304:1111
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

CALLBACK, event 0, msg length 76, bvci 0x1002
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 81 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 85
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 3a 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 08 03 66 6f 6f 03 62 61 72 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 24 9d 75 

result (ACT PDP CTX REQ (REPLACE APN)) = 85

PROCESSING ACT PDP CTX REQ (REMOVE APN) from 0x01020304:1111
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

CALLBACK, event 0, msg length 76, bvci 0x1002
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 71 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 75
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 30 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 85 fa 60 

result (ACT PDP CTX REQ (REMOVE APN)) = 75

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 9
    RAID patched              (SGSN): 2
    APN patched                     : 3
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI efe2b700 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING DETACH REQ from 0x01020304:1111
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 15 01 c0 19 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 7e e1 41 

CALLBACK, event 0, msg length 44, bvci 0x1002
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 15 01 c0 19 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 7e e1 41 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 44 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 48
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 15 01 c0 19 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 7e e1 41 

result (DETACH REQ) = 48

PROCESSING DETACH ACC from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 15 08 06 00 f7 35 f0 

CALLBACK, event 0, msg length 67, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 15 08 06 00 f7 35 f0 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 67 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 71
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 15 08 06 00 f7 35 f0 

result (DETACH ACC) = 71

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 10
    RAID patched              (SGSN): 2
    APN patched                     : 3
    Attach Request count            : 1
    TLLI-Cache: 0
--- RA update ---

PROCESSING RA UPD REQ from 0x01020304:1111
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 11 22 33 40 50 60 70 80 00 80 0e 00 3e 01 c0 15 08 08 10 11 22 33 40 50 60 1d 19 13 42 33 57 2b f7 c8 48 02 13 48 50 c8 48 02 14 48 50 c8 48 02 17 49 10 c8 48 02 00 19 8b b2 92 17 16 27 07 04 31 02 e5 e0 32 02 20 00 96 3e 97 

CALLBACK, event 0, msg length 85, bvci 0x1002
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 11 22 33 40 50 60 70 80 00 80 0e 00 3e 01 c0 15 08 08 10 11 22 33 40 50 60 1d 19 13 42 33 57 2b f7 c8 48 02 13 48 50 c8 48 02 14 48 50 c8 48 02 17 49 10 c8 48 02 00 19 8b b2 92 17 16 27 07 04 31 02 e5 e0 32 02 20 00 96 3e 97 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 85 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 89
00 00 10 02 01 bb c5 46 79 00 00 04 08 88 21 63 54 40 50 60 70 80 00 80 0e 00 3e 01 c0 15 08 08 10 21 63 54 40 50 60 1d 19 13 42 33 57 2b f7 c8 48 02 13 48 50 c8 48 02 14 48 50 c8 48 02 17 49 10 c8 48 02 00 19 8b b2 92 17 16 27 07 04 31 02 e5 e0 32 02 20 00 1d f0 41 

result (RA UPD REQ) = 89

PROCESSING RA UPD ACC from 0x05060708:32000
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9d 41 c0 19 08 09 00 49 21 63 54 40 50 60 19 54 ab b3 18 05 f4 ef e2 b7 00 17 16 d7 59 65 

CALLBACK, event 0, msg length 87, bvci 0x1002
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9d 41 c0 19 08 09 00 49 21 63 54 40 50 60 19 54 ab b3 18 05 f4 ef e2 b7 00 17 16 d7 59 65 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 87 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 91
00 00 10 02 00 bb c5 46 79 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9d 41 c0 19 08 09 00 49 11 22 33 40 50 60 19 54 ab b3 18 05 f4 ef e2 b7 00 17 16 3a 03 54 

result (RA UPD ACC) = 91

PROCESSING ACT PDP CTX REQ (REMOVE APN) from 0x01020304:1111
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

CALLBACK, event 0, msg length 76, bvci 0x1002
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 71 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 75
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 30 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 85 fa 60 

result (ACT PDP CTX REQ (REMOVE APN)) = 75

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 13
    RAID patched              (SGSN): 3
    APN patched                     : 4
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI bbc54679/efe2b700 -> bbc54679/efe2b700, IMSI 12131415161718, AGE 0
PROCESSING DETACH REQ (PWR OFF) from 0x01020304:1111
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 15 01 c0 19 08 05 09 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 84 0c eb 

CALLBACK, event 0, msg length 44, bvci 0x1002
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 15 01 c0 19 08 05 09 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 84 0c eb 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 44 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 48
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 15 01 c0 19 08 05 09 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 84 0c eb 

result (DETACH REQ (PWR OFF)) = 48

Gbproxy global:
Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 14
    RAID patched              (SGSN): 3
    APN patched                     : 4
    Attach Request count            : 1
    TLLI-Cache: 0
--- Bad cases ---

TLLI is already detached, shouldn't patch
PROCESSING ACT PDP CTX REQ from 0x01020304:1111
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

CALLBACK, event 0, msg length 76, bvci 0x1002
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 11 22 33 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 76 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 80
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 75 30 00 80 0e 00 35 01 c0 0d 0a 41 05 03 0c 00 00 1f 10 00 00 00 00 00 00 00 00 02 01 21 28 03 02 61 62 27 14 80 80 21 10 01 00 00 10 81 06 00 00 00 00 83 06 00 00 00 00 5a ff 02 

result (ACT PDP CTX REQ) = 80

Invalid RAI, shouldn't patch
PROCESSING BVC_SUSPEND_ACK from 0x05060708:32000
00 00 00 00 0c 1f 84 cc d1 75 8b 1b 86 00 f1 99 00 63 60 1d 81 01 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 0c 1f 84 cc d1 75 8b 1b 86 00 f1 99 00 63 60 1d 81 01 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 24 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 28
00 00 00 00 41 07 81 05 15 92 0c 1f 84 cc d1 75 8b 1b 86 00 f1 99 00 63 60 1d 81 01 

result (BVC_SUSPEND_ACK) = 28

Gbproxy global:
    Invalid Routing Area Identifier : 1
    Patch error: no peer            : 1
Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 15
    RAID patched              (SGSN): 3
    APN patched                     : 4
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI efe2b700 -> efe2b700, IMSI (none), AGE 0
=== test_gbproxy_ptmsi_patching ===
--- Initialise SGSN ---

MESSAGE to SGSN at 0x05060708:32000, msg length 12
02 00 81 01 01 82 01 01 04 82 01 00 

PROCESSING RESET_ACK from 0x05060708:32000
03 01 82 01 01 04 82 01 00 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0a 

result (RESET_ACK) = 1

PROCESSING ALIVE_ACK from 0x05060708:32000
0b 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
06 

result (ALIVE_ACK) = 1

PROCESSING UNBLOCK_ACK from 0x05060708:32000
07 

==> got signal NS_UNBLOCK, NS-VC 0x0101/5.6.7.8:32000

result (UNBLOCK_ACK) = 0

PROCESSING ALIVE from 0x05060708:32000
0a 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0b 

result (ALIVE) = 1

--- Initialise BSS 1 ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x1001(4097), NSEI 0x1000(4096)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 10 01 04 82 10 00 

==> got signal NS_RESET, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 10 01 04 82 10 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 21 63 54 40 50 60 10 00 

result (BVC_RESET) = 22

PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

Current NS-VCIs:
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Gbproxy global:
Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 1
    TLLI-Cache: 0
--- Send message from BSS 1 to SGSN, BVCI 0x1002 ---

PROCESSING ATTACH REQUEST from 0x01020304:1111
00 00 10 02 01 80 00 de ad 00 00 04 08 88 00 f1 99 00 63 60 12 34 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 11 22 33 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 16 6d 01 

CALLBACK, event 0, msg length 75, bvci 0x1002
00 00 10 02 01 80 00 de ad 00 00 04 08 88 00 f1 99 00 63 60 12 34 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 11 22 33 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 16 6d 01 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 75 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 79
00 00 10 02 01 7c 69 fb 81 00 00 04 08 88 21 63 54 00 63 60 12 34 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 11 22 33 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 16 6d 01 

result (ATTACH REQUEST) = 79

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 2
    TLLI patched              (BSS ): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead -> 7c69fb81, IMSI (none), AGE 0
PROCESSING IDENT REQUEST from 0x05060708:32000
00 00 10 02 00 7c 69 fb 81 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

CALLBACK, event 0, msg length 23, bvci 0x1002
00 00 10 02 00 7c 69 fb 81 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 23 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 27
00 00 10 02 00 80 00 de ad 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

result (IDENT REQUEST) = 27

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 2
    TLLI patched              (BSS ): 1
    TLLI patched              (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead -> 7c69fb81, IMSI (none), AGE 0
PROCESSING IDENT RESPONSE from 0x01020304:1111
00 00 10 02 01 80 00 de ad 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 11 01 c0 05 08 16 08 11 12 13 14 15 16 17 18 ad 05 28 

CALLBACK, event 0, msg length 40, bvci 0x1002
00 00 10 02 01 80 00 de ad 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 11 01 c0 05 08 16 08 11 12 13 14 15 16 17 18 ad 05 28 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 40 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 44
00 00 10 02 01 7c 69 fb 81 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 11 01 c0 05 08 16 08 11 12 13 14 15 16 17 18 ad 05 28 

result (IDENT RESPONSE) = 44

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 3
    TLLI patched              (BSS ): 2
    TLLI patched              (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead -> 7c69fb81, IMSI 12131415161718, AGE 0
PROCESSING ATTACH ACCEPT from 0x05060708:32000
00 00 10 02 00 7c 69 fb 81 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 21 63 54 40 50 60 19 cd d7 08 17 16 18 05 f4 ef e2 b7 00 53 62 f1 

CALLBACK, event 0, msg length 88, bvci 0x1002
00 00 10 02 00 7c 69 fb 81 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 21 63 54 40 50 60 19 cd d7 08 17 16 18 05 f4 ef e2 b7 00 53 62 f1 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 88 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 92
00 00 10 02 00 80 00 de ad 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 11 22 33 40 50 60 19 cd d7 08 17 16 18 05 f4 c0 0f 73 04 50 22 97 

result (ATTACH ACCEPT) = 92

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 3
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 2
    TLLI patched              (SGSN): 2
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead/c00f7304 -> 7c69fb81/efe2b700, IMSI 12131415161718, AGE 0
PROCESSING ATTACH COMPLETE from 0x01020304:1111
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 08 01 c0 09 08 03 39 d7 bc 

CALLBACK, event 0, msg length 31, bvci 0x1002
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 08 01 c0 09 08 03 39 d7 bc 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 31 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 35
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 08 01 c0 09 08 03 39 d7 bc 

result (ATTACH COMPLETE) = 35

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 4
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 3
    TLLI patched              (SGSN): 2
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead/c00f7304 -> 7c69fb81/efe2b700, IMSI 12131415161718, AGE 0
PROCESSING GMM INFO from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

CALLBACK, event 0, msg length 66, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 66 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 70
00 00 10 02 00 c0 0f 73 04 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

result (GMM INFO) = 70

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 4
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 3
    TLLI patched              (SGSN): 3
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING XID (UL) from 0x01020304:1111
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 0f 41 fb 01 00 0e 00 64 11 05 16 01 90 66 b3 28 

CALLBACK, event 0, msg length 38, bvci 0x1002
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 0f 41 fb 01 00 0e 00 64 11 05 16 01 90 66 b3 28 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 38 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 42
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 0f 41 fb 01 00 0e 00 64 11 05 16 01 90 66 b3 28 

result (XID (UL)) = 42

PROCESSING XID (DL) from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 8c 41 fb 30 84 10 61 b6 64 e4 a9 1a 9e 

CALLBACK, event 0, msg length 70, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 8c 41 fb 30 84 10 61 b6 64 e4 a9 1a 9e 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 70 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 74
00 00 10 02 00 c0 0f 73 04 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 8c 41 fb 30 84 10 61 b6 64 e4 a9 1a 9e 

result (XID (DL)) = 74

PROCESSING LL11 DNS QUERY (UL) from 0x01020304:1111
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 42 0b c0 01 65 00 00 00 45 00 00 38 95 72 00 00 45 11 20 85 0a c0 07 e4 ac 10 01 0a ad ab 00 35 00 24 0e 1c 3b e0 01 00 00 01 00 00 00 00 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 47 8f 07 

CALLBACK, event 0, msg length 89, bvci 0x1002
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 42 0b c0 01 65 00 00 00 45 00 00 38 95 72 00 00 45 11 20 85 0a c0 07 e4 ac 10 01 0a ad ab 00 35 00 24 0e 1c 3b e0 01 00 00 01 00 00 00 00 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 47 8f 07 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 89 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 93
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 42 0b c0 01 65 00 00 00 45 00 00 38 95 72 00 00 45 11 20 85 0a c0 07 e4 ac 10 01 0a ad ab 00 35 00 24 0e 1c 3b e0 01 00 00 01 00 00 00 00 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 47 8f 07 

result (LL11 DNS QUERY (UL)) = 93

PROCESSING LL11 DNS RESP (DL) from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 00 d0 4b c0 01 65 00 00 00 45 00 00 c6 00 00 40 00 3e 11 7c 69 ac 10 01 0a 0a c0 07 e4 00 35 ad ab 00 b2 74 4e 3b e0 81 80 00 01 00 01 00 05 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 c0 0c 00 01 00 01 00 00 0e 10 00 04 c1 63 90 58 c0 0e 00 02 00 01 00 00 0e 10 00 16 03 6e 73 32 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 03 6e 65 74 00 c0 0e 00 02 00 01 00 00 0e 10 00 10 02 6e 73 01 73 08 70 6c 75 73 6c 69 6e 65 c0 14 c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 0e c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 5f c0 0e 00 02 00 01 00 00 0e 10 00 12 02 6e 73 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 c0 14 aa df 31 

CALLBACK, event 0, msg length 267, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 00 d0 4b c0 01 65 00 00 00 45 00 00 c6 00 00 40 00 3e 11 7c 69 ac 10 01 0a 0a c0 07 e4 00 35 ad ab 00 b2 74 4e 3b e0 81 80 00 01 00 01 00 05 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 c0 0c 00 01 00 01 00 00 0e 10 00 04 c1 63 90 58 c0 0e 00 02 00 01 00 00 0e 10 00 16 03 6e 73 32 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 03 6e 65 74 00 c0 0e 00 02 00 01 00 00 0e 10 00 10 02 6e 73 01 73 08 70 6c 75 73 6c 69 6e 65 c0 14 c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 0e c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 5f c0 0e 00 02 00 01 00 00 0e 10 00 12 02 6e 73 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 c0 14 aa df 31 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 267 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 271
00 00 10 02 00 c0 0f 73 04 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 00 d0 4b c0 01 65 00 00 00 45 00 00 c6 00 00 40 00 3e 11 7c 69 ac 10 01 0a 0a c0 07 e4 00 35 ad ab 00 b2 74 4e 3b e0 81 80 00 01 00 01 00 05 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 c0 0c 00 01 00 01 00 00 0e 10 00 04 c1 63 90 58 c0 0e 00 02 00 01 00 00 0e 10 00 16 03 6e 73 32 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 03 6e 65 74 00 c0 0e 00 02 00 01 00 00 0e 10 00 10 02 6e 73 01 73 08 70 6c 75 73 6c 69 6e 65 c0 14 c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 0e c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 5f c0 0e 00 02 00 01 00 00 0e 10 00 12 02 6e 73 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 c0 14 aa df 31 

result (LL11 DNS RESP (DL)) = 271

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 6
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 5
    TLLI patched              (SGSN): 5
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING LLC_DISCARDED from 0x01020304:1111
00 00 00 00 2c 1f 84 c0 0f 73 04 0f 81 01 04 82 10 02 25 83 00 00 0c 

CALLBACK, event 0, msg length 19, bvci 0x0000
00 00 00 00 2c 1f 84 c0 0f 73 04 0f 81 01 04 82 10 02 25 83 00 00 0c 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 19 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 23
00 00 00 00 2c 1f 84 ef e2 b7 00 0f 81 01 04 82 10 02 25 83 00 00 0c 

result (LLC_DISCARDED) = 23

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 6
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 6
    TLLI patched              (SGSN): 5
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING BVC_SUSPEND from 0x01020304:1111
00 00 00 00 0b 1f 84 c0 0f 73 04 1b 86 11 22 33 40 50 60 

CALLBACK, event 0, msg length 15, bvci 0x0000
00 00 00 00 0b 1f 84 c0 0f 73 04 1b 86 11 22 33 40 50 60 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 15 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 19
00 00 00 00 0b 1f 84 ef e2 b7 00 1b 86 21 63 54 40 50 60 

result (BVC_SUSPEND) = 19

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 7
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 7
    TLLI patched              (SGSN): 5
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING BVC_SUSPEND_ACK from 0x05060708:32000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 21 63 54 40 50 60 1d 81 01 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 21 63 54 40 50 60 1d 81 01 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 22
00 00 00 00 0c 1f 84 c0 0f 73 04 1b 86 11 22 33 40 50 60 1d 81 01 

result (BVC_SUSPEND_ACK) = 22

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 7
    RAID patched              (SGSN): 2
    TLLI patched              (BSS ): 7
    TLLI patched              (SGSN): 6
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING LLC_DISCARDED from 0x01020304:1111
00 00 00 00 2c 1f 84 c0 0f 73 04 0f 81 01 04 82 ee e1 25 83 00 00 0c 

CALLBACK, event 0, msg length 19, bvci 0x0000
00 00 00 00 2c 1f 84 c0 0f 73 04 0f 81 01 04 82 ee e1 25 83 00 00 0c 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 19 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 23
00 00 00 00 2c 1f 84 ef e2 b7 00 0f 81 01 04 82 ee e1 25 83 00 00 0c 

result (LLC_DISCARDED) = 23

Gbproxy global:
PROCESSING BVC_SUSPEND_ACK from 0x05060708:32000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 00 f1 99 00 63 60 1d 81 01 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 00 f1 99 00 63 60 1d 81 01 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 24 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 28
00 00 00 00 41 07 81 05 15 92 0c 1f 84 ef e2 b7 00 1b 86 00 f1 99 00 63 60 1d 81 01 

result (BVC_SUSPEND_ACK) = 28

Gbproxy global:
    Invalid Routing Area Identifier : 1
    Patch error: no peer            : 1
PROCESSING BVC_SUSPEND_ACK from 0x05060708:32000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 99 69 54 40 50 60 1d 81 01 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 99 69 54 40 50 60 1d 81 01 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 22
00 00 00 00 0c 1f 84 c0 0f 73 04 1b 86 11 22 33 40 50 60 1d 81 01 

result (BVC_SUSPEND_ACK) = 22

Gbproxy global:
    Invalid Routing Area Identifier : 1
    Patch error: no peer            : 1
PROCESSING DETACH REQ from 0x01020304:1111
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 15 01 c0 0d 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 37 67 c6 

CALLBACK, event 0, msg length 44, bvci 0x1002
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 15 01 c0 0d 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 37 67 c6 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 44 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 48
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 15 01 c0 0d 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 37 67 c6 

result (DETACH REQ) = 48

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 8
    RAID patched              (SGSN): 3
    TLLI patched              (BSS ): 9
    TLLI patched              (SGSN): 7
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING DETACH ACC from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 0d 08 06 00 aa ab ee 

CALLBACK, event 0, msg length 67, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 0d 08 06 00 aa ab ee 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 67 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 71
00 00 10 02 00 c0 0f 73 04 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 0d 08 06 00 aa ab ee 

result (DETACH ACC) = 71

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 8
    RAID patched              (SGSN): 3
    TLLI patched              (BSS ): 9
    TLLI patched              (SGSN): 8
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI-Cache: 0
Gbproxy global:
    Invalid Routing Area Identifier : 1
    Patch error: no peer            : 1
=== test_gbproxy_imsi_acquisition ===
--- Initialise SGSN ---

MESSAGE to SGSN at 0x05060708:32000, msg length 12
02 00 81 01 01 82 01 01 04 82 01 00 

PROCESSING RESET_ACK from 0x05060708:32000
03 01 82 01 01 04 82 01 00 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0a 

result (RESET_ACK) = 1

PROCESSING ALIVE_ACK from 0x05060708:32000
0b 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
06 

result (ALIVE_ACK) = 1

PROCESSING UNBLOCK_ACK from 0x05060708:32000
07 

==> got signal NS_UNBLOCK, NS-VC 0x0101/5.6.7.8:32000

result (UNBLOCK_ACK) = 0

PROCESSING ALIVE from 0x05060708:32000
0a 

MESSAGE to SGSN at 0x05060708:32000, msg length 1
0b 

result (ALIVE) = 1

--- Initialise BSS 1 ---

Setup NS-VC: remote 0x01020304:1111, NSVCI 0x1001(4097), NSEI 0x1000(4096)

PROCESSING RESET from 0x01020304:1111
02 00 81 01 01 82 10 01 04 82 10 00 

==> got signal NS_RESET, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 9
03 01 82 10 01 04 82 10 00 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0a 

result (RESET) = 9

PROCESSING ALIVE from 0x01020304:1111
0a 

MESSAGE to BSS at 0x01020304:1111, msg length 1
0b 

result (ALIVE) = 1

PROCESSING UNBLOCK from 0x01020304:1111
06 

==> got signal NS_UNBLOCK, NS-VC 0x1001/1.2.3.4:1111

MESSAGE to BSS at 0x01020304:1111, msg length 1
07 

result (UNBLOCK) = 1

PROCESSING ALIVE_ACK from 0x01020304:1111
0b 

result (ALIVE_ACK) = 0

Setup BSSGP: remote 0x01020304:1111, BVCI 0x1002(4098)

PROCESSING BVC_RESET from 0x01020304:1111
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 22 04 82 10 02 07 81 08 08 88 11 22 33 40 50 60 10 00 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 22
00 00 00 00 22 04 82 10 02 07 81 08 08 88 21 63 54 40 50 60 10 00 

result (BVC_RESET) = 22

PROCESSING BVC_RESET_ACK from 0x05060708:32000
00 00 00 00 23 04 82 10 02 

CALLBACK, event 0, msg length 5, bvci 0x0000
00 00 00 00 23 04 82 10 02 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 5 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 9
00 00 00 00 23 04 82 10 02 

result (BVC_RESET_ACK) = 9

Current NS-VCIs:
    VCI 0x1001, NSEI 0x1000, peer 0x01020304:1111
    VCI 0x0101, NSEI 0x0100, peer 0x05060708:32000
         NS-VC Block count         : 1

Gbproxy global:
Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 1
    TLLI-Cache: 0
--- Send message from BSS 1 to SGSN, BVCI 0x1002 ---

PROCESSING ATTACH REQUEST from 0x01020304:1111
00 00 10 02 01 80 00 de ad 00 00 04 08 88 00 f1 99 00 63 60 12 34 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 11 22 33 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 16 6d 01 

CALLBACK, event 0, msg length 75, bvci 0x1002
00 00 10 02 01 80 00 de ad 00 00 04 08 88 00 f1 99 00 63 60 12 34 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 11 22 33 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 16 6d 01 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 24 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 28
00 00 10 02 00 80 00 de ad 00 50 20 16 82 02 58 0e 00 09 41 c0 01 08 15 01 ff 6c ba 

result (ATTACH REQUEST) = 0

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead -> 7c69fb81, IMSI (none), AGE 0, IMSI acquisition in progress, stored messages
PROCESSING IDENT RESPONSE from 0x01020304:1111
00 00 10 02 01 80 00 de ad 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 11 01 c0 05 08 16 08 11 12 13 14 15 16 17 18 ad 05 28 

CALLBACK, event 0, msg length 40, bvci 0x1002
00 00 10 02 01 80 00 de ad 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 11 01 c0 05 08 16 08 11 12 13 14 15 16 17 18 ad 05 28 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 75 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 79
00 00 10 02 01 7c 69 fb 81 00 00 04 08 88 21 63 54 00 63 60 12 34 00 80 0e 00 34 01 c0 01 08 01 02 f5 e0 21 08 02 05 f4 fb c5 46 79 11 22 33 40 50 60 19 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 16 6d 01 

result (IDENT RESPONSE) = 0

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 2
    TLLI patched              (BSS ): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead -> 7c69fb81, IMSI 12131415161718, AGE 0
PROCESSING IDENT REQUEST from 0x05060708:32000
00 00 10 02 00 7c 69 fb 81 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

CALLBACK, event 0, msg length 23, bvci 0x1002
00 00 10 02 00 7c 69 fb 81 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 23 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 27
00 00 10 02 00 80 00 de ad 00 50 20 16 82 02 58 0e 89 41 c0 01 08 15 01 ff 6c ba 

result (IDENT REQUEST) = 27

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 2
    TLLI patched              (BSS ): 1
    TLLI patched              (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead -> 7c69fb81, IMSI 12131415161718, AGE 0
PROCESSING IDENT RESPONSE from 0x01020304:1111
00 00 10 02 01 80 00 de ad 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 11 01 c0 09 08 16 08 11 12 13 14 15 16 17 18 ba 14 c3 

CALLBACK, event 0, msg length 40, bvci 0x1002
00 00 10 02 01 80 00 de ad 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 11 01 c0 09 08 16 08 11 12 13 14 15 16 17 18 ba 14 c3 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 40 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 44
00 00 10 02 01 7c 69 fb 81 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 11 01 c0 09 08 16 08 11 12 13 14 15 16 17 18 ba 14 c3 

result (IDENT RESPONSE) = 44

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 3
    TLLI patched              (BSS ): 2
    TLLI patched              (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead -> 7c69fb81, IMSI 12131415161718, AGE 0
PROCESSING ATTACH ACCEPT from 0x05060708:32000
00 00 10 02 00 7c 69 fb 81 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 21 63 54 40 50 60 19 cd d7 08 17 16 18 05 f4 ef e2 b7 00 53 62 f1 

CALLBACK, event 0, msg length 88, bvci 0x1002
00 00 10 02 00 7c 69 fb 81 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 21 63 54 40 50 60 19 cd d7 08 17 16 18 05 f4 ef e2 b7 00 53 62 f1 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 88 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 92
00 00 10 02 00 80 00 de ad 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 9e 41 c0 05 08 02 01 49 04 11 22 33 40 50 60 19 cd d7 08 17 16 18 05 f4 c0 0f 73 04 50 22 97 

result (ATTACH ACCEPT) = 92

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 3
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 2
    TLLI patched              (SGSN): 2
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead/c00f7304 -> 7c69fb81/efe2b700, IMSI 12131415161718, AGE 0
PROCESSING ATTACH COMPLETE from 0x01020304:1111
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 08 01 c0 0d 08 03 55 1c ea 

CALLBACK, event 0, msg length 31, bvci 0x1002
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 08 01 c0 0d 08 03 55 1c ea 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 31 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 35
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 08 01 c0 0d 08 03 55 1c ea 

result (ATTACH COMPLETE) = 35

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 4
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 3
    TLLI patched              (SGSN): 2
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI 8000dead/c00f7304 -> 7c69fb81/efe2b700, IMSI 12131415161718, AGE 0
PROCESSING GMM INFO from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

CALLBACK, event 0, msg length 66, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 66 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 70
00 00 10 02 00 c0 0f 73 04 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 88 41 c0 09 08 21 04 ba 3d 

result (GMM INFO) = 70

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 4
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 3
    TLLI patched              (SGSN): 3
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING XID (UL) from 0x01020304:1111
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 0f 41 fb 01 00 0e 00 64 11 05 16 01 90 66 b3 28 

CALLBACK, event 0, msg length 38, bvci 0x1002
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 0f 41 fb 01 00 0e 00 64 11 05 16 01 90 66 b3 28 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 38 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 42
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 0f 41 fb 01 00 0e 00 64 11 05 16 01 90 66 b3 28 

result (XID (UL)) = 42

PROCESSING XID (DL) from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 8c 41 fb 30 84 10 61 b6 64 e4 a9 1a 9e 

CALLBACK, event 0, msg length 70, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 8c 41 fb 30 84 10 61 b6 64 e4 a9 1a 9e 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 70 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 74
00 00 10 02 00 c0 0f 73 04 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 8c 41 fb 30 84 10 61 b6 64 e4 a9 1a 9e 

result (XID (DL)) = 74

PROCESSING LL11 DNS QUERY (UL) from 0x01020304:1111
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 42 0b c0 01 65 00 00 00 45 00 00 38 95 72 00 00 45 11 20 85 0a c0 07 e4 ac 10 01 0a ad ab 00 35 00 24 0e 1c 3b e0 01 00 00 01 00 00 00 00 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 47 8f 07 

CALLBACK, event 0, msg length 89, bvci 0x1002
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 42 0b c0 01 65 00 00 00 45 00 00 38 95 72 00 00 45 11 20 85 0a c0 07 e4 ac 10 01 0a ad ab 00 35 00 24 0e 1c 3b e0 01 00 00 01 00 00 00 00 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 47 8f 07 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 89 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 93
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 42 0b c0 01 65 00 00 00 45 00 00 38 95 72 00 00 45 11 20 85 0a c0 07 e4 ac 10 01 0a ad ab 00 35 00 24 0e 1c 3b e0 01 00 00 01 00 00 00 00 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 47 8f 07 

result (LL11 DNS QUERY (UL)) = 93

PROCESSING LL11 DNS RESP (DL) from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 00 d0 4b c0 01 65 00 00 00 45 00 00 c6 00 00 40 00 3e 11 7c 69 ac 10 01 0a 0a c0 07 e4 00 35 ad ab 00 b2 74 4e 3b e0 81 80 00 01 00 01 00 05 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 c0 0c 00 01 00 01 00 00 0e 10 00 04 c1 63 90 58 c0 0e 00 02 00 01 00 00 0e 10 00 16 03 6e 73 32 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 03 6e 65 74 00 c0 0e 00 02 00 01 00 00 0e 10 00 10 02 6e 73 01 73 08 70 6c 75 73 6c 69 6e 65 c0 14 c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 0e c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 5f c0 0e 00 02 00 01 00 00 0e 10 00 12 02 6e 73 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 c0 14 aa df 31 

CALLBACK, event 0, msg length 267, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 00 d0 4b c0 01 65 00 00 00 45 00 00 c6 00 00 40 00 3e 11 7c 69 ac 10 01 0a 0a c0 07 e4 00 35 ad ab 00 b2 74 4e 3b e0 81 80 00 01 00 01 00 05 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 c0 0c 00 01 00 01 00 00 0e 10 00 04 c1 63 90 58 c0 0e 00 02 00 01 00 00 0e 10 00 16 03 6e 73 32 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 03 6e 65 74 00 c0 0e 00 02 00 01 00 00 0e 10 00 10 02 6e 73 01 73 08 70 6c 75 73 6c 69 6e 65 c0 14 c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 0e c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 5f c0 0e 00 02 00 01 00 00 0e 10 00 12 02 6e 73 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 c0 14 aa df 31 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 267 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 271
00 00 10 02 00 c0 0f 73 04 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 00 d0 4b c0 01 65 00 00 00 45 00 00 c6 00 00 40 00 3e 11 7c 69 ac 10 01 0a 0a c0 07 e4 00 35 ad ab 00 b2 74 4e 3b e0 81 80 00 01 00 01 00 05 00 00 01 6d 05 68 65 69 73 65 02 64 65 00 00 01 00 01 c0 0c 00 01 00 01 00 00 0e 10 00 04 c1 63 90 58 c0 0e 00 02 00 01 00 00 0e 10 00 16 03 6e 73 32 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 03 6e 65 74 00 c0 0e 00 02 00 01 00 00 0e 10 00 10 02 6e 73 01 73 08 70 6c 75 73 6c 69 6e 65 c0 14 c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 0e c0 0e 00 02 00 01 00 00 0e 10 00 05 02 6e 73 c0 5f c0 0e 00 02 00 01 00 00 0e 10 00 12 02 6e 73 0c 70 6f 70 2d 68 61 6e 6e 6f 76 65 72 c0 14 aa df 31 

result (LL11 DNS RESP (DL)) = 271

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 6
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 5
    TLLI patched              (SGSN): 5
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING LLC_DISCARDED from 0x01020304:1111
00 00 00 00 2c 1f 84 c0 0f 73 04 0f 81 01 04 82 10 02 25 83 00 00 0c 

CALLBACK, event 0, msg length 19, bvci 0x0000
00 00 00 00 2c 1f 84 c0 0f 73 04 0f 81 01 04 82 10 02 25 83 00 00 0c 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 19 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 23
00 00 00 00 2c 1f 84 ef e2 b7 00 0f 81 01 04 82 10 02 25 83 00 00 0c 

result (LLC_DISCARDED) = 23

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 6
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 6
    TLLI patched              (SGSN): 5
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING LLC_DISCARDED from 0x05060708:32000
00 00 00 00 2c 1f 84 ef e2 b7 00 0f 81 01 04 82 10 02 25 83 00 00 0c 

CALLBACK, event 0, msg length 19, bvci 0x0000
00 00 00 00 2c 1f 84 ef e2 b7 00 0f 81 01 04 82 10 02 25 83 00 00 0c 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 25 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 29
00 00 00 00 41 07 81 27 15 93 2c 1f 84 ef e2 b7 00 0f 81 01 04 82 10 02 25 83 00 00 0c 

result (LLC_DISCARDED) = 29

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 6
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 6
    TLLI patched              (SGSN): 6
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING BVC_SUSPEND from 0x01020304:1111
00 00 00 00 0b 1f 84 c0 0f 73 04 1b 86 11 22 33 40 50 60 

CALLBACK, event 0, msg length 15, bvci 0x0000
00 00 00 00 0b 1f 84 c0 0f 73 04 1b 86 11 22 33 40 50 60 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 15 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 19
00 00 00 00 0b 1f 84 ef e2 b7 00 1b 86 21 63 54 40 50 60 

result (BVC_SUSPEND) = 19

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 7
    RAID patched              (SGSN): 1
    TLLI patched              (BSS ): 7
    TLLI patched              (SGSN): 6
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING BVC_SUSPEND_ACK from 0x05060708:32000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 21 63 54 40 50 60 1d 81 01 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 21 63 54 40 50 60 1d 81 01 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 22
00 00 00 00 0c 1f 84 c0 0f 73 04 1b 86 11 22 33 40 50 60 1d 81 01 

result (BVC_SUSPEND_ACK) = 22

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 7
    RAID patched              (SGSN): 2
    TLLI patched              (BSS ): 7
    TLLI patched              (SGSN): 7
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING LLC_DISCARDED from 0x01020304:1111
00 00 00 00 2c 1f 84 c0 0f 73 04 0f 81 01 04 82 ee e1 25 83 00 00 0c 

CALLBACK, event 0, msg length 19, bvci 0x0000
00 00 00 00 2c 1f 84 c0 0f 73 04 0f 81 01 04 82 ee e1 25 83 00 00 0c 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 19 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 23
00 00 00 00 2c 1f 84 ef e2 b7 00 0f 81 01 04 82 ee e1 25 83 00 00 0c 

result (LLC_DISCARDED) = 23

Gbproxy global:
    BSSGP protocol error      (SGSN): 1
PROCESSING BVC_SUSPEND_ACK from 0x05060708:32000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 00 f1 99 00 63 60 1d 81 01 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 00 f1 99 00 63 60 1d 81 01 

NS UNITDATA MESSAGE to SGSN, BVCI 0x0000, msg length 24 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 28
00 00 00 00 41 07 81 05 15 92 0c 1f 84 ef e2 b7 00 1b 86 00 f1 99 00 63 60 1d 81 01 

result (BVC_SUSPEND_ACK) = 28

Gbproxy global:
    Invalid Routing Area Identifier : 1
    BSSGP protocol error      (SGSN): 1
    Patch error: no peer            : 1
PROCESSING BVC_SUSPEND_ACK from 0x05060708:32000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 99 69 54 40 50 60 1d 81 01 

CALLBACK, event 0, msg length 18, bvci 0x0000
00 00 00 00 0c 1f 84 ef e2 b7 00 1b 86 99 69 54 40 50 60 1d 81 01 

NS UNITDATA MESSAGE to BSS, BVCI 0x0000, msg length 18 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 22
00 00 00 00 0c 1f 84 c0 0f 73 04 1b 86 11 22 33 40 50 60 1d 81 01 

result (BVC_SUSPEND_ACK) = 22

Gbproxy global:
    Invalid Routing Area Identifier : 1
    BSSGP protocol error      (SGSN): 1
    Patch error: no peer            : 1
PROCESSING DETACH REQ from 0x01020304:1111
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 15 01 c0 11 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 6d b1 de 

CALLBACK, event 0, msg length 44, bvci 0x1002
00 00 10 02 01 c0 0f 73 04 00 00 04 08 88 11 22 33 40 50 60 12 34 00 80 0e 00 15 01 c0 11 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 6d b1 de 

NS UNITDATA MESSAGE to SGSN, BVCI 0x1002, msg length 44 (gprs_ns_sendmsg)
MESSAGE to SGSN at 0x05060708:32000, msg length 48
00 00 10 02 01 ef e2 b7 00 00 00 04 08 88 21 63 54 40 50 60 12 34 00 80 0e 00 15 01 c0 11 08 05 01 18 05 f4 ef e2 b7 00 19 03 b9 97 cb 6d b1 de 

result (DETACH REQ) = 48

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 8
    RAID patched              (SGSN): 3
    TLLI patched              (BSS ): 9
    TLLI patched              (SGSN): 8
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI cache size                 : 1
    TLLI-Cache: 1
      TLLI c00f7304 -> efe2b700, IMSI 12131415161718, AGE 0
PROCESSING DETACH ACC from 0x05060708:32000
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 0d 08 06 00 aa ab ee 

CALLBACK, event 0, msg length 67, bvci 0x1002
00 00 10 02 00 ef e2 b7 00 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 0d 08 06 00 aa ab ee 

NS UNITDATA MESSAGE to BSS, BVCI 0x1002, msg length 67 (gprs_ns_sendmsg)
MESSAGE to BSS at 0x01020304:1111, msg length 71
00 00 10 02 00 c0 0f 73 04 00 50 20 16 82 02 58 13 99 18 b3 43 2b 25 96 62 00 60 80 9a c2 c6 62 00 60 80 ba c8 c6 62 00 60 80 00 0a 82 08 02 0d 88 11 12 13 14 15 16 17 18 00 81 00 0e 89 41 c0 0d 08 06 00 aa ab ee 

result (DETACH ACC) = 71

Peers:
  NSEI 4096, BVCI 4098, not blocked, RAI 112-332-16464-96
    RAID patched              (BSS ): 8
    RAID patched              (SGSN): 3
    TLLI patched              (BSS ): 9
    TLLI patched              (SGSN): 9
    P-TMSI patched            (SGSN): 1
    Attach Request count            : 1
    TLLI-Cache: 0
Gbproxy global:
    Invalid Routing Area Identifier : 1
    BSSGP protocol error      (SGSN): 1
    Patch error: no peer            : 1
Test TLLI info expiry

Test TLLI replacement:
  Add TLLI 1, IMSI 1
  Add TLLI 2, IMSI 1 (should replace TLLI 1)
  Peers:
    NSEI 0, BVCI 20, not blocked, RAI 0-0-0-0
      TLLI cache size                 : 1
      TLLI-Cache: 1
        TLLI c000162e, IMSI 03242526, AGE 0

Test IMSI replacement:
  Add TLLI 1, IMSI 1
  Add TLLI 1, IMSI 2 (should replace IMSI 1)
  Peers:
    NSEI 0, BVCI 20, not blocked, RAI 0-0-0-0
      TLLI cache size                 : 1
      TLLI-Cache: 1
        TLLI c00004d2, IMSI 06272829, AGE 0

Test TLLI expiry, max_len == 1:
  Add TLLI 1, IMSI 1
  Add TLLI 2, IMSI 2 (should replace IMSI 1)
  Peers:
    NSEI 0, BVCI 20, not blocked, RAI 0-0-0-0
      TLLI cache size                 : 1
      TLLI-Cache: 1
        TLLI c000162e, IMSI 06272829, AGE 0

Test TLLI expiry, max_age == 1:
  Add TLLI 1, IMSI 1 (should expire after timeout)
  Add TLLI 2, IMSI 2 (should not expire after timeout)
  Peers:
    NSEI 0, BVCI 20, not blocked, RAI 0-0-0-0
      TLLI cache size                 : 1
      TLLI-Cache: 1
        TLLI c000162e, IMSI 06272829, AGE 1

Test TLLI expiry, max_len == 2, max_age == 1:
  Add TLLI 1, IMSI 1 (should expire)
  Add TLLI 2, IMSI 2 (should expire after timeout)
  Add TLLI 3, IMSI 3 (should not expire after timeout)
  Peers:
    NSEI 0, BVCI 20, not blocked, RAI 0-0-0-0
      TLLI cache size                 : 3
      TLLI-Cache: 3
        TLLI c0000d80, IMSI 12345678, AGE 0
        TLLI c000162e, IMSI 06272829, AGE 1
        TLLI c00004d2, IMSI 03242526, AGE 2
  Remove stale TLLIs
  Peers:
    NSEI 0, BVCI 20, not blocked, RAI 0-0-0-0
      TLLI cache size                 : 1
      TLLI-Cache: 1
        TLLI c0000d80, IMSI 12345678, AGE 0

===== GbProxy test END

